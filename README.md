# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:

- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:

- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```

## Сборка

```
npm run build
```

или

```
yarn build
```

1. Класс Component<T>

В переменной Т класса дженерика содержится информация о типе данных компонентов, абстрактный класс выполняет функции управления компонентами интерфейса, включая изменение текста и изображений, а также переключение класса и рендеринг.
`protected constructor(protected readonly container: HTMLElement)` - защищенный конструктор который принимает данные для управления компонентами интерфейса.
Методы класса включают в себя возможности:

- setImage, setText, toggleClass для манипулирования элементами.
- render для формирования HTML-элемента с установленными свойствами.

2. Класс Model<T>

Для того чтобы отличать компонент от обычных объектов с данными, абстрактный класс реализует методы мониторинга изменений компонентов. Компонент, который подлежит отслеживанию, передается в конструкторе.
`constructor(data:Partial<T>, events: IEvenets)` - принимает начальный данные для модели и объект событий для уведомления о изменениях в модели.
Класс имеет такие методы:

- emitChanges в классе служит для передачи информации о модификациях, произошедших в модели.

3. Класс EventEmitter

Класс предоставляет функционал для управления событиями и уведомления подписчиков о наступлении этих событий. Методы on, off и emit используются для подписки на события, отписки от событий и уведомления подписчиков соответственно. Также доступны методы onAll и offAll для управления всеми событиями и сброса всех подписчиков. Интересным дополнением является метод trigger, который позволяет генерировать события с аргументами и использовать их в качестве обработчика в других классах.
События будут вызываться классами независимо от класса EventEmitter, который не привязан к ним напрямую.

4. Класс AppState

Состояние всего приложения (корзина, заказ, главная страница) управляется одним классом.
Методы:

- Установить превью товара с помощью setPreview.
- Получить стоимость всех товаров из корзины с getTotalPrice.
- Удалить товар из корзины с removeProductFromBasket.
- Валидировать поля заказа с validateOrder.
- Установить товары в каталог с setCatalog.
- Очистить корзину с clearBasket.
- Установить значения поля заказа с setOrderField.
- Добавить товар в корзину с addProductInBasket.
- Получить список товаров с getBasket.
- Очистить поля заказа с clearOrder.

5. Класс Basket

Контейнер визуализации корзины, класс Component, наследует абстрактный класс.
Элемент HTMLElement и EventEmitter передаются в конструктор для корзины.
Функция отображения корзины выполняется в контейнере.
Ключевые свойства и методы:

- items список товаров в корзине
- total общая стоимость товаров в корзине

6. Класс Modal

Класс Modal является наследником Component, имеет функциональность показа модального окна. При создании экземпляра необходимо передать HTMLElement для отображения в модальном окне и EventEmitter для взаимодействия с остальными компонентами.
Методы и ключевые свойства модального окна:

- render() - функция отображения модального окна в компоненте
- open() - метод для открытия модального окна
- content - компонент, который отображается в модальном окне
- close() - функция для закрытия модального окна

7. Класс Page

При создании нового экземпляра класса Component, важно учитывать, что он наследуется от абстрактного класса. Главная страница приложения отображается с помощью этого класса, который принимает на вход элемент HTMLElement (body) и EventEmitter для обмена информацией с остальными компонентами.
Ключевые свойства и методы:

- counter счетчик товаров в корзине
- catalog католог с карточками товаров
- locked состояние блокировки прокрутки страницы

8. Класс Product

Когда кнопка нажимается, конструктор абстрактного класса, унаследованного от класса Component, принимает на вход имя стиля компонента и контейнер шаблона, который является HTMLElement. Этот класс выполняет функцию управления продуктом и его отображения.
Ключевые свойства и методы:

- id уникальный идентификатор продукта
- title название продукта
- category категория продукта
- price цена продукта
- image ссылка на изображение продукта
- description описание продукта

9. Order

Компонент класса Form, наследуемый от абстрактного класса, выполняет функцию управления и отображения заказа. В конструкторе указывается action - действия на кнопку и HTMLElement, представляющий собой шаблон страницы заказа. При наличии кнопок с особым стилем button_alt в шаблоне, компонент реагирует на изменения в них, аналогично радио-кнопкам.
Методы:

- email адрес электронной почты покупателя
- payment метод оплаты, выбранный клиентом
- address местоположение физического адреса клиента
- phone контактный номер телефона клиента

10. Success

Конструктор принимает HTMLElement и функцию кнопки для выполнения заказа. Этот класс наследуется от Component. Его основная задача - отображение результатов выполнения заказа.
Методы и ключевые свойства:

- Описание результата - description.
- Заголовок окна - title.

11. Класс Form<T>

Для создания формы, отображения и управления используется абстрактный класс, который наследует абстрактный класс Component. Конструктор принимает входной параметр HTMLFormElement и EventEmitter для обеспечения взаимодействия с другими компонентами.
Ключевые свойства и методы:

- valid переключатель доступности кнопки submit формы
- errors ошибки полученные при валидации формы
- render() метод для отображения формы в контейнере
- onInputChange() метод реагирующий на изменение инпутов формы

Реализация методов для контроля изменений в свойствах, отслеживание состояний форм и отправка формы - вот, что делает управление проектом. Функция, вызываемая при событии submit, и элемент для взаимодействия - вот что принимает конструктор.
Методы:

- render применяется для создания HTML-элементов на основе свойств формы, а метод onInputChange используется для мониторинга изменений формы.

Ключевые типы данных:

interface ICartView {
items: HTMLElement[];
total: number;
}

interface IProductActions {
onClick: (event: MouseEvent) => void;
}

interface IProductUI<T> {
index: number;
title: string;
description: string;
price: string;
image: string;
category: string;
status: T;
}

type CatalogChangeEvent = {
catalog: IProduct[];
};

interface IFormState {
valid: boolean;
errors: string[];
}

interface IModalData {
content: HTMLElement;
}

interface IPage {
counter: number;
catalog: HTMLElement[];
locked: boolean;
}

interface ISuccess {
title: string;
description: string;
}

interface ISuccessActions {
onClick: () => void;
}

export type FormErrors = Partial<Record<keyof IOrder, string>>;

export interface IOrderResult {
id: string[];
total: number;
error?: string;
}

export interface IProduct {
id: string;
title: string;
image: string;
price: number | null;
description: string;
category: string;
}

export interface Products {
total: number;
items: IProduct[];
}

export interface IOrder {
payment: string;
email: string;
phone: string;
address: string;
total: number;
items: string[];
}

export interface IWebLakerApi {
getProducts: () => Promise<Products>;
getProduct: (id: string) => Promise<IProduct>;
createOrder: (order: IOrder) => Promise<IOrderResult>;
}

## Об архитектуре

Взаимодействия внутри приложения происходят через события. Модели инициализируют события, слушатели событий в основном коде выполняют передачу данных компонентам отображения, а также вычислениями между этой передачей, и еще они меняют значения в моделях.
